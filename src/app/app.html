<div class="main-container">
  <!-- Main Page -->
  <div class="main-page">
    <div class="start-message" (click)="toggleDrawer()">
      <h1>Click to Open Settings</h1>
      <p>Configure your advanced options</p>
    </div>
  </div>

  <!-- Drawer Overlay -->
  <div class="drawer-overlay" [class.active]="isDrawerOpen()" (click)="closeDrawer()"></div>
  
  <!-- Settings Drawer -->
  <div class="settings-drawer" [class.open]="isDrawerOpen()">
    <!-- Header -->
    <div class="drawer-header">
      <div class="header-left">
        <h1>Row Settings</h1>
        <div class="preset-section">
          <span class="preset-label">Preset:</span>
          <div class="preset-dropdown" (click)="togglePresetDropdown()">
            <span>Default</span>
            <i class="fas fa-chevron-down" [class.rotated]="showPresetDropdown"></i>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="header-btn" (click)="openSettings()" title="Settings">
          <i class="fas fa-cog"></i>
        </button>
        <button class="header-btn" (click)="toggleView()" title="Grid View">
          <i class="fas fa-th-large"></i>
        </button>
        <button class="header-btn more-btn" (click)="toggleMoreMenu()" title="More Options">
          <i class="fas fa-ellipsis-v"></i>
          @if (showMoreMenu) {
            <div class="more-menu" (click)="$event.stopPropagation()">
              <div class="menu-item" (click)="exportSettings()">
                <i class="fas fa-download"></i>
                Export Settings
              </div>
              <div class="menu-item" (click)="importSettings()">
                <i class="fas fa-upload"></i>
                Import Settings
              </div>
              <div class="menu-item" (click)="resetSettings()">
                <i class="fas fa-undo"></i>
                Reset All
              </div>
              <div class="menu-item danger" (click)="closeDrawer()">
                <i class="fas fa-times"></i>
                Close Panel
              </div>
            </div>
          }
        </button>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-navigation">
      <button 
        class="tab-btn"
        [class.active]="activeTab() === 'content'"
        (click)="setActiveTab('content')">
        Content
      </button>
      <button 
        class="tab-btn"
        [class.active]="activeTab() === 'design'"
        (click)="setActiveTab('design')">
        Design
      </button>
      <button 
        class="tab-btn"
        [class.active]="activeTab() === 'advanced'"
        (click)="setActiveTab('advanced')">
        Advanced
      </button>
    </div>

    <!-- Content Area -->
    <div class="drawer-content">
      <!-- Search Bar - Exact style from image -->
      <div class="search-section">
        <div class="search-bar">
          <input 
            type="text" 
            class="search-input"
            placeholder="Search Options"
            [(ngModel)]="searchTerm"
            (input)="onSearch()">
          <button class="filter-btn" 
                  [class.active]="showFilterDropdown"
                  (click)="toggleFilterDropdown($event)">
            <i class="fas fa-plus"></i>
            <span>Filter</span>
          </button>
        </div>
      </div>

      <!-- Filter Dropdown -->
      @if (showFilterDropdown) {
        <div class="filter-dropdown" (click)="$event.stopPropagation()">
          <div class="filter-section">
            <div class="section-header">
              <i class="fas fa-sort-amount-down"></i>
              <h3>Sort Options</h3>
            </div>
            <div class="filter-group">
              <label class="filter-option">
                <input type="radio" name="sort" value="default" [(ngModel)]="filterSettings.sortBy" (change)="applyFilters()">
                <span class="radio-mark"></span>
                <span class="option-text">Default Order</span>
              </label>
              <label class="filter-option">
                <input type="radio" name="sort" value="alphabetical-asc" [(ngModel)]="filterSettings.sortBy" (change)="applyFilters()">
                <span class="radio-mark"></span>
                <span class="option-text">A-Z Ascending</span>
              </label>
              <label class="filter-option">
                <input type="radio" name="sort" value="alphabetical-desc" [(ngModel)]="filterSettings.sortBy" (change)="applyFilters()">
                <span class="radio-mark"></span>
                <span class="option-text">Z-A Descending</span>
              </label>
            </div>
          </div>
          <div class="filter-actions">
            <button class="action-btn secondary" (click)="clearAllFilters()">
              <i class="fas fa-undo"></i>
              Reset Filters
            </button>
            <button class="action-btn primary" (click)="applyFilters(); showFilterDropdown = false">
              <i class="fas fa-check"></i>
              Apply
            </button>
          </div>
        </div>
      }

      <!-- Accordion Container -->
      <div class="accordion-container">
        <!-- Content Tab -->
        @if (activeTab() === 'content') {
          @for (item of getFilteredItems(currentContentItems); track item.id) {
            <div class="accordion-item" [class.expanded]="item.expanded" (click)="toggleAccordion('content', item.id)">
              <div class="accordion-header">
                <span class="item-title">{{ item.title }}</span>
                <i class="fas chevron-icon" [class.fa-chevron-down]="!item.expanded" [class.fa-chevron-up]="item.expanded"></i>
              </div>
              @if (item.expanded) {
                <div class="accordion-content">
                  <p class="item-description">{{ item.description }}</p>
                </div>
              }
            </div>
          }
        }

        <!-- Design Tab -->
        @if (activeTab() === 'design') {
          @for (item of getFilteredItems(currentDesignItems); track item.id) {
            <div class="accordion-item" [class.expanded]="item.expanded" (click)="toggleAccordion('design', item.id)">
              <div class="accordion-header">
                <span class="item-title">{{ item.title }}</span>
                <i class="fas chevron-icon" [class.fa-chevron-down]="!item.expanded" [class.fa-chevron-up]="item.expanded"></i>
              </div>
              @if (item.expanded) {
                <div class="accordion-content">
                  @if (item.title === 'Transform') {
                    <div class="transform-section">
                      <h4>Transform</h4>
                      <div class="transform-controls">
                        <button class="transform-btn" [class.active]="selectedTransform === 'move'" (click)="selectTransform('move')">
                          <i class="fas fa-arrows-alt"></i>
                        </button>
                        <button class="transform-btn" [class.active]="selectedTransform === 'scale'" (click)="selectTransform('scale')">
                          <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <button class="transform-btn" [class.active]="selectedTransform === 'rotate'" (click)="selectTransform('rotate')">
                          <i class="fas fa-redo"></i>
                        </button>
                        <button class="transform-btn" [class.active]="selectedTransform === 'skew'" (click)="selectTransform('skew')">
                          <i class="fas fa-italic"></i>
                        </button>
                        <button class="transform-btn" [class.active]="selectedTransform === 'expand'" (click)="selectTransform('expand')">
                          <i class="fas fa-expand"></i>
                        </button>
                      </div>
                      
                      <div class="transform-workspace">
                        <div class="position-grid">
                          @for (dot of gridDots; track $index) {
                            <button class="grid-dot" 
                                   [class.active]="dot.active" 
                                   (click)="selectGridDot($index)">
                            </button>
                          }
                          <div class="position-label">{{ gridPosition }}</div>
                        </div>
                        
                        <div class="transform-slider">
                          <div class="slider-container">
                            <div class="slider-track" (click)="moveSlider($event)">
                              <div class="slider-handle" [style.top.%]="sliderPosition"></div>
                            </div>
                          </div>
                          <div class="slider-value">{{ verticalPosition }}</div>
                        </div>
                      </div>
                    </div>
                  } @else {
                    <p class="item-description">{{ item.description }}</p>
                  }
                </div>
              }
            </div>
          }
        }

        <!-- Advanced Tab -->
        @if (activeTab() === 'advanced') {
          @for (item of getFilteredItems(currentAdvancedItems); track item.id) {
            <div class="accordion-item" [class.expanded]="item.expanded" (click)="toggleAccordion('advanced', item.id)">
              <div class="accordion-header">
                <span class="item-title">{{ item.title }}</span>
                <i class="fas chevron-icon" [class.fa-chevron-down]="!item.expanded" [class.fa-chevron-up]="item.expanded"></i>
              </div>
              @if (item.expanded) {
                <div class="accordion-content">
                  <p class="item-description">{{ item.description }}</p>
                </div>
              }
            </div>
          }
        }
      </div>

      <!-- Empty State -->
      @if (getFilteredItemsCount() === 0) {
        <div class="empty-state">
          <div class="empty-icon">
            <i class="fas fa-search"></i>
          </div>
          <h3>No items found</h3>
          <p>Try adjusting your search terms</p>
          <button class="clear-filters-btn" (click)="clearAllFilters()">
            <i class="fas fa-undo"></i>
            Clear filters
          </button>
        </div>
      }
    </div>
  </div>
</div>
